// ==UserScript==
// @name         Reputation Investigation
// @namespace    https://github.com/rjrudman/Userscripts/ReputationInvestigation
// @version      2.1.6
// @author       Rob
// @match        *://*.stackexchange.com/*/*?tab=reputation*
// @match        *://*.stackoverflow.com/users/*/*?tab=reputation*
// @match        *://*.superuser.com/*/*?tab=reputation*
// @match        *://*.serverfault.com/*/*?tab=reputation*
// @match        *://*.askubuntu.com/*/*?tab=reputation*
// @match        *://*.stackapps.com/*/*?tab=reputation*
// @match        *://*.mathoverflow.net/*/*?tab=reputation*
// @exclude      *://chat.stackexchange.com/*
// @exclude      *://chat.meta.stackexchange.com/*
// @exclude      *://chat.stackoverflow.com/*
// @exclude      *://blog.stackoverflow.com/*
// @exclude      *://*.area51.stackexchange.com/*
// @require      https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.22.2/moment.min.js
// @require      https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js
// @grant        GM_xmlhttpRequest
// ==/UserScript==
(function(r){var n={};function a(e){if(n[e]){return n[e].exports}var t=n[e]={i:e,l:false,exports:{}};r[e].call(t.exports,t,t.exports,a);t.l=true;return t.exports}a.m=r;a.c=n;a.d=function(e,t,r){if(!a.o(e,t)){Object.defineProperty(e,t,{enumerable:true,get:r})}};a.r=function(e){if(typeof Symbol!=="undefined"&&Symbol.toStringTag){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}Object.defineProperty(e,"__esModule",{value:true})};a.t=function(t,e){if(e&1)t=a(t);if(e&8)return t;if(e&4&&typeof t==="object"&&t&&t.__esModule)return t;var r=Object.create(null);a.r(r);Object.defineProperty(r,"default",{enumerable:true,value:t});if(e&2&&typeof t!="string")for(var n in t)a.d(r,n,function(e){return t[e]}.bind(null,n));return r};a.n=function(t){var e=t&&t.__esModule?function e(){return t["default"]}:function e(){return t};a.d(e,"a",e);return e};a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)};a.p="";return a(a.s=3)})([function(e,t,r){"use strict";r.r(t);r.d(t,"__extends",function(){return a});r.d(t,"__assign",function(){return o});r.d(t,"__rest",function(){return i});r.d(t,"__decorate",function(){return u});r.d(t,"__param",function(){return s});r.d(t,"__metadata",function(){return c});r.d(t,"__awaiter",function(){return l});r.d(t,"__generator",function(){return f});r.d(t,"__exportStar",function(){return d});r.d(t,"__values",function(){return p});r.d(t,"__read",function(){return v});r.d(t,"__spread",function(){return _});r.d(t,"__await",function(){return y});r.d(t,"__asyncGenerator",function(){return h});r.d(t,"__asyncDelegator",function(){return g});r.d(t,"__asyncValues",function(){return m});r.d(t,"__makeTemplateObject",function(){return b});r.d(t,"__importStar",function(){return x});r.d(t,"__importDefault",function(){return w});
/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */var n=function(e,t){n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r]};return n(e,t)};function a(e,t){n(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}var o=function(){o=Object.assign||function e(t){for(var r,n=1,a=arguments.length;n<a;n++){r=arguments[n];for(var o in r)if(Object.prototype.hasOwnProperty.call(r,o))t[o]=r[o]}return t};return o.apply(this,arguments)};function i(e,t){var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0)r[n]=e[n];if(e!=null&&typeof Object.getOwnPropertySymbols==="function")for(var a=0,n=Object.getOwnPropertySymbols(e);a<n.length;a++)if(t.indexOf(n[a])<0)r[n[a]]=e[n[a]];return r}function u(e,t,r,n){var a=arguments.length,o=a<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,r):n,i;if(typeof Reflect==="object"&&typeof Reflect.decorate==="function")o=Reflect.decorate(e,t,r,n);else for(var u=e.length-1;u>=0;u--)if(i=e[u])o=(a<3?i(o):a>3?i(t,r,o):i(t,r))||o;return a>3&&o&&Object.defineProperty(t,r,o),o}function s(r,n){return function(e,t){n(e,t,r)}}function c(e,t){if(typeof Reflect==="object"&&typeof Reflect.metadata==="function")return Reflect.metadata(e,t)}function l(o,i,u,s){return new(u||(u=Promise))(function(e,t){function r(e){try{a(s.next(e))}catch(e){t(e)}}function n(e){try{a(s["throw"](e))}catch(e){t(e)}}function a(t){t.done?e(t.value):new u(function(e){e(t.value)}).then(r,n)}a((s=s.apply(o,i||[])).next())})}function f(e,r){var n={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},a,o,i,t;return t={next:u(0),throw:u(1),return:u(2)},typeof Symbol==="function"&&(t[Symbol.iterator]=function(){return this}),t;function u(t){return function(e){return s([t,e])}}function s(t){if(a)throw new TypeError("Generator is already executing.");while(n)try{if(a=1,o&&(i=t[0]&2?o["return"]:t[0]?o["throw"]||((i=o["return"])&&i.call(o),0):o.next)&&!(i=i.call(o,t[1])).done)return i;if(o=0,i)t=[t[0]&2,i.value];switch(t[0]){case 0:case 1:i=t;break;case 4:n.label++;return{value:t[1],done:false};case 5:n.label++;o=t[1];t=[0];continue;case 7:t=n.ops.pop();n.trys.pop();continue;default:if(!(i=n.trys,i=i.length>0&&i[i.length-1])&&(t[0]===6||t[0]===2)){n=0;continue}if(t[0]===3&&(!i||t[1]>i[0]&&t[1]<i[3])){n.label=t[1];break}if(t[0]===6&&n.label<i[1]){n.label=i[1];i=t;break}if(i&&n.label<i[2]){n.label=i[2];n.ops.push(t);break}if(i[2])n.ops.pop();n.trys.pop();continue}t=r.call(e,n)}catch(e){t=[6,e];o=0}finally{a=i=0}if(t[0]&5)throw t[1];return{value:t[0]?t[1]:void 0,done:true}}}function d(e,t){for(var r in e)if(!t.hasOwnProperty(r))t[r]=e[r]}function p(e){var t=typeof Symbol==="function"&&e[Symbol.iterator],r=0;if(t)return t.call(e);return{next:function(){if(e&&r>=e.length)e=void 0;return{value:e&&e[r++],done:!e}}}}function v(e,t){var r=typeof Symbol==="function"&&e[Symbol.iterator];if(!r)return e;var n=r.call(e),a,o=[],i;try{while((t===void 0||t-- >0)&&!(a=n.next()).done)o.push(a.value)}catch(e){i={error:e}}finally{try{if(a&&!a.done&&(r=n["return"]))r.call(n)}finally{if(i)throw i.error}}return o}function _(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(v(arguments[t]));return e}function y(e){return this instanceof y?(this.v=e,this):new y(e)}function h(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var a=r.apply(e,t||[]),o,i=[];return o={},n("next"),n("throw"),n("return"),o[Symbol.asyncIterator]=function(){return this},o;function n(n){if(a[n])o[n]=function(r){return new Promise(function(e,t){i.push([n,r,e,t])>1||u(n,r)})}}function u(e,t){try{s(a[e](t))}catch(e){f(i[0][3],e)}}function s(e){e.value instanceof y?Promise.resolve(e.value.v).then(c,l):f(i[0][2],e)}function c(e){u("next",e)}function l(e){u("throw",e)}function f(e,t){if(e(t),i.shift(),i.length)u(i[0][0],i[0][1])}}function g(n){var e,a;return e={},t("next"),t("throw",function(e){throw e}),t("return"),e[Symbol.iterator]=function(){return this},e;function t(t,r){e[t]=n[t]?function(e){return(a=!a)?{value:y(n[t](e)),done:t==="return"}:r?r(e):e}:r}}function m(a){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=a[Symbol.asyncIterator],t;return e?e.call(a):(a=typeof p==="function"?p(a):a[Symbol.iterator](),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(n){t[n]=a[n]&&function(r){return new Promise(function(e,t){r=a[n](r),o(e,t,r.done,r.value)})}}function o(t,e,r,n){Promise.resolve(n).then(function(e){t({value:e,done:r})},e)}}function b(e,t){if(Object.defineProperty){Object.defineProperty(e,"raw",{value:t})}else{e.raw=t}return e}function x(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)if(Object.hasOwnProperty.call(e,r))t[r]=e[r];t.default=e;return t}function w(e){return e&&e.__esModule?e:{default:e}}},function(e,t,r){var n,a;!(n=[r,t,r(2)],a=function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:true});r.AllVoteTypes=["asker_accepts_answer","asker_unaccept_answer","answer_accepted","answer_unaccepted","voter_downvotes","voter_undownvotes","post_downvoted","post_undownvoted","post_upvoted","post_unupvoted","suggested_edit_approval_received","post_flagged_as_spam","post_flagged_as_offensive","bounty_given","bounty_earned","bounty_cancelled","post_deleted","post_undeleted","association_bonus","arbitrary_reputation_change","vote_fraud_reversal","post_migrated","user_deleted","example_upvoted","example_unupvoted","proposed_change_approved","doc_link_upvoted","doc_link_unupvoted","doc_source_removed","suggested_edit_approval_overridden"];r.ReversalTypes=["asker_unaccept_answer","answer_unaccepted","user_deleted","vote_fraud_reversal"];r.ReversableTypes=["asker_accepts_answer","answer_accepted","post_downvoted","post_upvoted"];r.OppositePairs=["asker_accepts_answer","asker_unaccept_answer","answer_accepted","answer_unaccepted","voter_downvotes","voter_undownvotes","post_downvoted","post_undownvoted","post_upvoted","post_unupvoted","post_deleted","post_undeleted"];r.VoteOppositePairs={asker_accepts_answer:"asker_unaccept_answer",asker_unaccept_answer:"asker_accepts_answer",answer_accepted:"answer_unaccepted",answer_unaccepted:"answer_accepted",voter_downvotes:"voter_undownvotes",voter_undownvotes:"voter_downvotes",post_downvoted:"post_undownvoted",post_undownvoted:"post_downvoted",post_upvoted:"post_unupvoted",post_unupvoted:"post_upvoted",post_deleted:"post_undeleted",post_undeleted:"post_deleted"};r.VoteReversalPairs={asker_accepts_answer:["asker_unaccept_answer"],answer_accepted:["answer_unaccepted"],post_downvoted:["user_deleted","vote_fraud_reversal"],post_upvoted:["user_deleted","vote_fraud_reversal"],suggested_edit_approval_received:["vote_fraud_reversal"]};function n(t){return!!r.ReversableTypes.find(function(e){return e===t})}r.IsReversableType=n;function a(t){return!!r.ReversalTypes.find(function(e){return e===t})}r.IsReversalType=a;function o(t){return!!r.OppositePairs.find(function(e){return e===t})}r.HasOppositePair=o;function i(e){return t.UnionOfArraysToArrayOfUnions(r.VoteReversalPairs[e])}r.GetReversalTypes=i}.apply(t,n),a!==undefined&&(e.exports=a))},function(e,t,r){var n,a;!(n=[r,t],a=function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:true});function r(e){var t=document.head||document.getElementsByTagName("head")[0];var r=document.createElement("style");r.type="text/css";if(r.styleSheet){r.styleSheet.cssText=e}else{r.appendChild(document.createTextNode(e))}t.appendChild(r)}t.AddStyleText=r;function n(e,n){return e.reduce(function(e,t){var r=n(t);(e[r]=e[r]||[]).push(t);return e},{})}t.GroupBy=n;function a(e){return e.filter(function(e,t,r){return r.indexOf(e)===t})}t.Distinct=a;function o(e){return e}t.UnionOfArraysToArrayOfUnions=o}.apply(t,n),a!==undefined&&(e.exports=a))},function(e,t,r){var n,a;!(n=[r,t,r(0),r(2),r(4),r(5),r(1)],a=function(e,t,j,r,I,C,T){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n="\n.detailed_reputation_table {\n    width: 100%;\n    font-size: 10px;\n}\n\n.detailed_reputation_table td {\n    padding: 5px;\n}\n\n.detailed_reputation_table tr:nth-child(even) {\n    background-color: #f2f2f2;\n}\n\n.detailed_reputation_table_header {\n    font-size: 12px;\n    border-top: 1px solid black;\n}\n\n.post-matcher {\n    opacity: 0;\n    padding-left: 5px;\n}\n\n.detailed_reputation_table tr > td.post-col:hover .post-matcher,\n.detailed_reputation_table_highlighted .post-matcher {\n    opacity: 1;\n}\n\n.user-details-div {\n    display: inline;\n    margin-left: 15px;\n}\n.user-details-div a {\n    margin-left: 5px;\n}\n\n.summary-table {\n    width: 100%;\n    margin: 5px;\n    font-size: 15px;\n}\n\n.summary-table p {\n    color: red;\n    display: inline;\n}\n\n.reversal-type {\n    cursor: default;\n}\n\n.rep-change {\n    font-size: 12px;\n    font-weight: bold;\n}\n.rep-change-positive {\n    color: green;\n}\n.rep-change-negative {\n    color: red;\n}\n#detailed_reputation_body > tr.reversal {\n    background-color: rgb(239, 145, 125);\n}\ntr.reversal > td.post-col > a,\ntr.reversal > td.post-col > a:hover {\n    color: #12009e\n}\n";function M(e,t){if(e%2===0){e+=t/2}var r=360/t*e%360;var n="hsla("+r+", 80%, 50%, 0.3)";return n}var E=function(e){var t=26;var r=65;if(e>=t){var n=e%t;return E(e/t-1)+String.fromCharCode(n+r)}return String.fromCharCode(e+r)};$(function(){r.AddStyleText(n);$.event.special.destroyed={remove:function(e){if(e.handler){e.handler()}}};StackExchange.initialized.then(function(){var g=StackExchange.user.options.userId;var i=/&sort=detailed/;function u(){var e=$('<a class="s-btn s-btn__muted s-btn__outlined s-btn__xs js-user-tab-sort" href="/users/'+g+'?tab=reputation&amp;sort=detailed">Detailed</a>');if(window.location.href.match(i)){$(".js-user-tab-sorts a").removeClass("is-selected");$(e).addClass("is-selected");$("#stats").prepend('<div id="rep-page-summary">');m(45,3);var t=$('<a style="margin-left: 10px" href="https://stackoverflow.com/admin/xref-user-ips/'+g+'" target="_blank">xref</a>');var r=$('<a style="margin-left: 10px" href="https://stackoverflow.com/admin/show-user-votes/'+g+'" target="_blank">votes</a>');if(StackExchange.options.user.isModerator){$("#stats").prepend(t);$("#stats").prepend(r)}var n=$('<input type="number" value="3" />');$("#stats").prepend(n);$("#stats").prepend('<label style="margin-right: 15px; margin-left: 15px;">Minimum number of votes</label>');var a=$('<input type="number" value="45" />');$("#stats").prepend(a);$("#stats").prepend('<label style="margin-right: 15px;">Number of seconds between votes</label>');var o=function(){var e=parseInt(a.val(),10);var t=parseInt(n.val(),10);m(e,t)};a.change(o);n.change(o)}e.bind("destroyed",function(){setTimeout(function(){u()})});$(".js-user-tab-sorts").append(e)}u();function m(p,v){var _=$("#rep-page-container");_.empty();var y=$("#rep-page-summary");y.empty();var h=$(".user-tab-footer");h.empty();var e=I.GetCurrentReputationPage(g);var P=[];var R=[];var S=function(){P.forEach(function(e){return e.removeClass("detailed_reputation_table_highlighted")});P=[]};var B=function(e){P.forEach(function(e){return e.removeClass("detailed_reputation_table_highlighted")});P=R[e];P.forEach(function(e){return e.addClass("detailed_reputation_table_highlighted")})};e.then(function(e){var t,r;if(e.hasMore){var n=$('<a href="javascript:void(0);">Load more</a>');n.click(function(){n.hide();I.GetNextReputationPage(g).then(function(){return m(p,v)})});h.append(n)}var b=JSON.parse(JSON.stringify(e));var a=C.ProcessEvents(b.items,v,p);a.sort(function(e,t){return t.creation_date-e.creation_date});var o=$('\n                    <table class="detailed_reputation_table">\n                        <tbody id="detailed_reputation_body">\n                        </tbody>\n                    </table>\n                    ');var x=["user_deleted","vote_fraud_reversal"];var w=o.find("#detailed_reputation_body");var k=[];var O=Math.max.apply(Math,j.__spread(a.map(function(e){return e.BucketIndex})))+1;var i=function(t){var e=void 0;if(t.Cancelled||t.reputation_change===0){e="rep-change-neutral"}else if(t.reputation_change>0){e="rep-change-positive"}else{e="rep-change-negative"}var r=$("\n                    <tr>\n                        <td>"+moment.unix(t.creation_date).utc().format("YYYY-MM-DD HH:mm:ss")+"</td>\n                        <td>"+t.reputation_history_type+'</td>\n                        <td id="rep-change" class="rep-change '+e+'">'+(t.reputation_change>=0?"+":"")+t.reputation_change+'</td>\n                        <td class="post-col"><a href="/q/'+t.post_id+'">'+(t.title||t.post_id+" (deleted)")+'</a><a class="post-matcher" href="javascript:void(0);">üìå</a></td>\n                        <td class="reversal-type"></td>\n                    </tr>\n                    ');if(t.reputation_history_type==="association_bonus"){r.find(".post-col").empty()}if(t.Cancelled){r.css("text-decoration","line-through")}var n=r.find(".post-matcher");var a=false;n.click(function(){if(!a&&r.hasClass("detailed_reputation_table_highlighted")){S()}else{B(t.post_id);a=false}});var o=r.find(".post-col");o.mouseenter(function(){if(!P.length){a=true;B(t.post_id)}});o.mouseleave(function(){if(a){S();a=false}});if(t.BucketIndex>=0){var i=false;var u=M(t.BucketIndex,O);if(k[t.BucketIndex]===undefined){var s=t.Bucket.length;var c=t.Bucket.filter(function(e){return!e.Cancelled}).length;var l=E(O-t.BucketIndex-1);var f=s===c?s+" events":c+" events ("+s+" total)";var d=t.Bucket.reduce(function(e,t){return e+t.reputation_change},0)+" reputation";var p="Group "+l+". "+f+". "+d;var v=x.indexOf(t.reputation_history_type)>=0?t.reputation_history_type==="vote_fraud_reversal"?"Reversal":"User deleted":"";if(v!==""){p+=" - "+v+" üî•";i=true;k[t.BucketIndex]=true}else{k[t.BucketIndex]=false}var _=$('\n                        <tr  class="detailed_reputation_table_header">\n                            <td colspan="7">\n                                '+p+"\n                            </td>\n                        </tr>\n                        ");if(i){_.addClass("reversal")}else{_.css("background-color",u)}w.append(_)}else{if(k[t.BucketIndex]){i=true}}if(i){r.addClass("reversal")}else{r.css("background-color",u)}var y=t.reputation_change;if(y===0){var h=b.items.find(function(e){return e.post_id===t.post_id&&e.reputation_history_type===t.reputation_history_type&&e.reputation_change>0});if(h){y=h.reputation_change;r.find("#rep-change").text(r.find("#rep-change").text()+" ("+y+")")}}if(!t.Cancelled&&T.IsReversableType(t.reputation_history_type)){var v=void 0;var g=void 0;if(t.ReversedBy.length>t.Pairs){v="‚úÖ";g="Vote was reversed"}else if(t.ReversedBy.length===0){v="‚ùå";g="Vote was not reversed"}else{v="‚ö†Ô∏è "+t.ReversedBy.length+"/"+(t.Pairs+1);g="Vote may not have been reversed"}var m=r.find(".reversal-type");m.text(v);m.attr("title",g)}}w.append(r);if(!R[t.post_id]){R[t.post_id]=[]}R[t.post_id].push(r)};try{for(var u=j.__values(a),s=u.next();!s.done;s=u.next()){var c=s.value;i(c)}}catch(e){t={error:e}}finally{try{if(s&&!s.done&&(r=u.return))r.call(u)}finally{if(t)throw t.error}}_.append(o);var l=a.filter(function(e){return!e.Cancelled&&e.IsBucketed&&T.IsReversableType(e.reputation_history_type)&&e.ReversedBy.length<=e.Pairs}).map(function(e){return{VoteSlice:1-e.ReversedBy.length/(e.Pairs+1),Reputation:e.reputation_change*(1-e.ReversedBy.length/(e.Pairs+1))}});if(l.length){var f=l.map(function(e){return e.VoteSlice}).reduce(function(e,t){return e+t},0);var d=l.map(function(e){return e.Reputation}).reduce(function(e,t){return e+t},0);y.append('\n                            <hr style="margin-bottom: 0px;" />\n                            <table class="summary-table">\n                                <tr>\n                                    <td><p>Total suspicious votes</p>: '+a.filter(function(e){return e.IsBucketed&&T.IsReversableType(e.reputation_history_type)}).length+"</td>\n                                    <td><p>Votes not reversed</p>: "+Math.round(f)+"</td>\n                                    <td><p>Reputation not reversed</p>: "+Math.round(d)+'</td>\n                                </tr>\n                            </table>\n                            <hr style="margin-bottom: 0px;" />\n                        ')}else{if(a.filter(function(e){return e.IsBucketed}).length===0){y.append('\n                        <hr style="margin-bottom: 0px;" />\n                        <p style="margin-top: 5px; margin-bottom: 5px; margin-left: 5px;">No suspicious votes detected</p>\n                        <hr style="margin-bottom: 0px;" />\n                    ')}else{y.append('\n                        <hr style="margin-bottom: 0px;" />\n                        <p style="margin-top: 5px; margin-bottom: 5px; margin-left: 5px;">All suspicious votes reversed</p>\n                        <hr style="margin-bottom: 0px;" />\n                    ')}}})}})})}.apply(t,n),a!==undefined&&(e.exports=a))},function(e,t,r){var n,a;!(n=[r,t,r(0)],a=function(e,t,v){"use strict";Object.defineProperty(t,"__esModule",{value:true});var a="ESZ7eo2s9qErse9jq5qFxg((";var o=0;var _=null;function r(n){return v.__awaiter(this,void 0,void 0,function(){var t;return v.__generator(this,function(e){t=new Promise(function(t,r){if(!_){i(n).then(function(e){if(_){t(_)}else{r()}})}else{t(_)}});return[2,t]})})}t.GetCurrentReputationPage=r;function i(e){o++;var r=location.hostname.replace(".com","");var t="https://api.stackexchange.com/2.2/users/"+e+"/reputation-history?key="+a+"&pagesize=100&page="+o+"&site="+r;var n=function(e){var t=e.filter(function(e){return!!e}).join(";");return"https://api.stackexchange.com/2.2/posts/"+t+"?key="+a+"&pagesize=100&site="+r+"&filter=!)qFc_2zhzdy0KDoW*IEu"};return fetch(t).then(function(e){return e.json()}).then(function(d){var p=d.items;var e=p.map(function(e){return e.post_id});var t=n(e);return fetch(t).then(function(e){return e.json()}).then(function(e){var t,r,n,a;var o={};try{for(var i=v.__values(e.items),u=i.next();!u.done;u=i.next()){var s=u.value;o[s.post_id+""]=s.title}}catch(e){t={error:e}}finally{try{if(u&&!u.done&&(r=i.return))r.call(i)}finally{if(t)throw t.error}}try{for(var c=v.__values(p),l=c.next();!l.done;l=c.next()){var f=l.value;f.title=o[f.post_id+""]}}catch(e){n={error:e}}finally{try{if(l&&!l.done&&(a=c.return))a.call(c)}finally{if(n)throw n.error}}if(_){_={items:_.items.concat(p),hasMore:d.has_more}}else{_={items:p,hasMore:d.has_more}}})})}t.GetNextReputationPage=i}.apply(t,n),a!==undefined&&(e.exports=a))},function(e,t,r){var n,a;!(n=[r,t,r(0),r(6),r(7)],a=function(e,t,u,s,c){"use strict";Object.defineProperty(t,"__esModule",{value:true});function r(e,t,r){if(t===void 0){t=3}if(r===void 0){r=3e4}var n=s.ProcessBuckets(e,r,t);var a=c.FindEventReversals(n.filter(function(e){return e.BucketSize>=t}));var o=n.filter(function(e){return e.BucketSize<t});var i=a.concat(o.map(function(e){return u.__assign({},e,{Reversed:[],ReversedBy:[],Pairs:0,OriginalEvent:e.OriginalEvent||e})}));i.sort(function(e,t){return e.creation_date-t.creation_date});return i}t.ProcessEvents=r}.apply(t,n),a!==undefined&&(e.exports=a))},function(e,t,r){var n,a;!(n=[r,t,r(0),r(1)],a=function(e,t,_,o){"use strict";Object.defineProperty(t,"__esModule",{value:true});function i(e){return e.reduce(function(e,t){return e+t.reputation_change},0)}function y(e){return Math.min.apply(Math,_.__spread(e.map(function(e){return e.creation_date})))}function h(e){return Math.max.apply(Math,_.__spread(e.map(function(e){return e.creation_date})))}function r(e,t,l){var r=e.map(function(e){return[_.__assign({},e,{IsBucketed:false,BucketIndex:0,BucketSize:0,Bucket:[],Cancelled:false,OriginalEvent:e})]});u(r,t);var f=0;r.sort(function(e,t){return y(e)-y(t)});var n=r.map(function(e){var t,r;var n=e.filter(function(e){return!e.Cancelled}).length>=l;var a=e.filter(function(e){return!e.Cancelled}).length;var o=n?f++:-1;var i=e.map(function(e){return _.__assign({},e,{IsBucketed:n,BucketIndex:o,BucketSize:a})});try{for(var u=_.__values(i),s=u.next();!s.done;s=u.next()){var c=s.value;c.Bucket=i}}catch(e){t={error:e}}finally{try{if(s&&!s.done&&(r=u.return))r.call(u)}finally{if(t)throw t.error}}return i}).reduce(function(e,t){return e.concat(t)},[]);n.sort(function(e,t){return e.creation_date-t.creation_date});return n}t.ProcessBuckets=r;function u(d,p){var t,e;var v=false;var r=function(t){var r,e,n,a;var o=d.filter(function(e){return e!==t&&(y(e)>=y(t)&&y(e)-h(t)<p||y(t)>=y(e)&&y(t)-h(e)<p)});o.sort(function(e,t){return y(e)-y(t)});try{for(var i=_.__values(o),u=i.next();!u.done;u=i.next()){var s=u.value;try{for(var c=_.__values(s),l=c.next();!l.done;l=c.next()){var f=l.value;if(g(t,s,f)){m(t,s,f);v=true}}}catch(e){n={error:e}}finally{try{if(l&&!l.done&&(a=c.return))a.call(c)}finally{if(n)throw n.error}}}}catch(e){r={error:e}}finally{try{if(u&&!u.done&&(e=i.return))e.call(i)}finally{if(r)throw r.error}}};try{for(var n=_.__values(d),a=n.next();!a.done;a=n.next()){var o=a.value;r(o)}}catch(e){t={error:e}}finally{try{if(a&&!a.done&&(e=n.return))e.call(n)}finally{if(t)throw t.error}}if(v){u(d,p);return}}function g(e,t,r){if(!o.IsReversableType(r.reputation_history_type)&&!o.IsReversalType(r.reputation_history_type)&&!o.HasOppositePair(r.reputation_history_type)){return false}if(o.HasOppositePair(r.reputation_history_type)&&!r.Cancelled){var n=o.VoteOppositePairs[r.reputation_history_type];if(e.some(function(e){return n===e.reputation_history_type&&r.post_id===e.post_id&&!e.Cancelled})){return true}}if(e.some(function(e){return e.post_id===r.post_id&&e.reputation_history_type===r.reputation_history_type&&!e.Cancelled})){return false}var a=i(e);if(r.reputation_change>=0&&a<0){return false}if(r.reputation_change<0&&a>=0){return false}if(e.length<t.length){return false}return true}function m(e,t,r){if(o.HasOppositePair(r.reputation_history_type)&&!r.Cancelled){var n=o.VoteOppositePairs[r.reputation_history_type];var a=e.filter(function(e){return n===e.reputation_history_type&&r.post_id===e.post_id&&!e.Cancelled});if(a.length){a[0].Cancelled=true;r.Cancelled=true}}e.unshift(r);t.splice(t.indexOf(r),1)}}.apply(t,n),a!==undefined&&(e.exports=a))},function(e,t,r){var n,a;!(n=[r,t,r(0),r(1)],a=function(e,t,d,p){"use strict";Object.defineProperty(t,"__esModule",{value:true});function r(e){var t=a(e);u(t);n(t);return t}t.FindEventReversals=r;function n(e){var t,r,n,a;var o=e.filter(function(e){return p.IsReversalType(e.reputation_history_type)});try{for(var i=d.__values(o),u=i.next();!u.done;u=i.next()){var s=u.value;try{for(var c=d.__values(s.Reversed),l=c.next();!l.done;l=c.next()){var f=l.value;f.Pairs=s.Reversed.length-1}}catch(e){n={error:e}}finally{try{if(l&&!l.done&&(a=c.return))a.call(c)}finally{if(n)throw n.error}}s.Pairs=0}}catch(e){t={error:e}}finally{try{if(u&&!u.done&&(r=i.return))r.call(i)}finally{if(t)throw t.error}}}function u(e){var t,r;var s=false;var c=e.filter(function(e){return p.IsReversalType(e.reputation_history_type)});var n=function(t){var r,e;if(t.Reversed.length===1){var n=t.Reversed[0];var a=c.filter(function(e){return e!==t&&e.Reversed.indexOf(n)>=0});n.ReversedBy=[t];try{for(var o=d.__values(a),i=o.next();!i.done;i=o.next()){var u=i.value;u.Reversed.splice(u.Reversed.indexOf(n),1);s=true}}catch(e){r={error:e}}finally{try{if(i&&!i.done&&(e=o.return))e.call(o)}finally{if(r)throw r.error}}}};try{for(var a=d.__values(c),o=a.next();!o.done;o=a.next()){var i=o.value;n(i)}}catch(e){t={error:e}}finally{try{if(o&&!o.done&&(r=a.return))r.call(a)}finally{if(t)throw t.error}}if(s){u(e)}}function a(e){var t,r;var n=e.map(function(e){return d.__assign({},e,{Reversed:[],ReversedBy:[],Pairs:0,OriginalEvent:e.OriginalEvent||e,Cancelled:e.Cancelled||false})});var l=function(t){return n.filter(function(e){return e.post_id===t})};var a=function(r){var t,e;var n=l(r.post_id).filter(function(e){return e!==r});var a=n.filter(function(e){return e.creation_date>r.creation_date});if(p.IsReversableType(r.reputation_history_type)){if(!r.Cancelled){var o=p.GetReversalTypes(r.reputation_history_type);var i=a.filter(function(t){return!!o.find(function(e){return e===t.reputation_history_type})&&(t.reputation_change===-1*r.reputation_change||t.reputation_change===0||r.reputation_change===0)});try{for(var u=d.__values(i),s=u.next();!s.done;s=u.next()){var c=s.value;if(!c.ReversedBy){c.ReversedBy=[]}c.Reversed.push(r)}}catch(e){t={error:e}}finally{try{if(s&&!s.done&&(e=u.return))e.call(u)}finally{if(t)throw t.error}}r.ReversedBy=i}}};try{for(var o=d.__values(n),i=o.next();!i.done;i=o.next()){var u=i.value;a(u)}}catch(e){t={error:e}}finally{try{if(i&&!i.done&&(r=o.return))r.call(o)}finally{if(t)throw t.error}}return n}}.apply(t,n),a!==undefined&&(e.exports=a))}]);